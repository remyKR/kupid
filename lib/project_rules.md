# 프로젝트 개발 룰

## 기본 원칙
- 이 프로젝트는 오직 사전에 정의된 개발 룰(규칙)에 의해서만 진행됩니다.
- 모든 개발, 설계, 코드 생성, UI 반영, 네이밍, 협업 등은 룰에 명시된 방식만을 따릅니다.
- 임의 해석, 창작, 임의 판단, 룰 무시 등은 절대 허용되지 않습니다.
- 새로운 작업/요구사항도 반드시 룰에 추가된 후에만 진행할 수 있습니다.

---

# 1. 서비스 전략

## 1.1 서비스 정의
- 이 서비스는 한국에 거주하는 한국 남성과 전세계 외국인 여성을 매칭해주는 소개팅앱입니다.

## 1.1.1 외국인 여성 한국 여행 인증 시스템
### 1단계: 항공권 인증
- **항공권에 기재된 입국 날짜가 오늘 이후**: 여행 예정 상태
- **항공권에 기재된 날짜가 오늘 이전**: 한국 여행중(위치 미인증)
- **한국 여행중(위치 미인증) → 한국 여행중(인증완료)**: GPS인증을 통해 한국이라는 것이 확인된 지 12시간 미만일 경우
- **GPS 인증**: 앱 실행시 자동 실행

### 항공권 사진 자동 분석 시스템
#### OCR 텍스트 추출
- 출발지/도착지 정보 (→ ICN, GMP 등 한국 공항 확인)
- 출발일/도착일 정보
- 항공사, 항공편명
- 승객 이름

#### 진위여부 검증
- 항공권 포맷 및 레이아웃 검증
- 항공사별 티켓 디자인 패턴 매칭
- 바코드/QR코드 존재 여부
- 필수 정보 누락 체크

#### 상태 자동 판별
- **입국일 > 오늘** → "여행 예정 상태"
- **입국일 ≤ 오늘** → "한국 여행중(위치 미인증)"

#### 부정 방지 시스템
- 이미지 메타데이터 분석
- 스크린샷 vs 실제 촬영 구분
- 이미지 편집 흔적 탐지
- 동일 항공권 중복 사용 방지

### 앱 실행 정의
앱 실행은 다음 중 하나의 상황을 의미합니다:
1. **앱 최초 실행**: 기기에서 앱 아이콘을 터치하여 앱이 시작되는 시점
2. **백그라운드에서 포그라운드로 전환**: 다른 앱을 사용하다가 Kupid 앱으로 돌아오는 시점
3. **앱 재시작**: 메모리 부족으로 앱이 종료된 후 다시 실행되는 시점
4. **시스템 재부팅 후 실행**: 기기 재시작 후 앱을 다시 실행하는 시점

GPS 인증은 위 모든 상황에서 자동으로 트리거되며, 사용자의 별도 액션 없이 백그라운드에서 실행됩니다.

## 1.1.2 회원가입 본인 인증 시스템
### SMS 휴대폰 번호 인증 (필수)
- 회원가입 시 휴대폰 번호 입력 필수
- SMS 인증번호 발송 및 확인
- 중복 가입 방지 (동일 번호로 재가입 불가)
- 인증 완료 후에만 회원가입 진행 가능
- 해외 번호도 지원 (외국인 여성 대상)

### 얼굴 인증 시스템 (Google Cloud Vision API) - 선택사항
- **프로필 사진과 본인 얼굴 매칭 기능**
- 회원가입 이후 원하는 사용자에게 제공되는 선택적 기능
- 사용자가 업로드한 프로필 사진과 실시간 셀카 비교
- Google Cloud Vision Face API를 통한 얼굴 유사도 분석
- 가짜 프로필 및 도용 방지
- 얼굴 인증 완료 시 프로필에 "인증완료" 배지 표시
- 인증받은 사용자 우선 노출 및 신뢰도 향상
- 얼굴 인식 실패 시 재시도 또는 고객센터 문의 안내

#### Google Cloud 인증 정보
- **OAuth 2.0 클라이언트 ID**: `635353106896-bqjrfjg2e6cfi69rq4kbr245l4o6n5jo.apps.googleusercontent.com`
- **Google Cloud Vision API Key**: `AIzaSyB8gbmGvAtdPsHRdLkFNkxJUKj9J9BgzIc`
- **용도**: Google Sign-In 및 Cloud Vision API 인증
- **보안 주의사항**: 프로덕션 환경에서는 서버 사이드 프록시 사용 권장

## 1.1.3 회원가입 프로필 입력 단계
### 1단계: 기본정보 입력
- **닉네임 입력** (2글자 이상 8글자 이하)
- **생년월일 입력** (만 18세 이상 가입 가능)
- **성별 선택** (남성/여성)
- **휴대폰 번호 SMS 인증** (필수)

### 2단계: 프로필 사진 입력
- **사진 업로드**: 1장 이상 10장 이내
- **동영상 지원**: 동영상 업로드 가능
- **저용량 고품질 파일 변환**: 동영상 자동 압축 및 최적화 기능
- **본인 인증 기능** (선택): Google Cloud Vision API를 통한 얼굴 인증

#### 프로필 사진 업로드 UI 규칙
- **업로드 버튼 제거**: 별도의 "사진 선택" 및 "동영상 선택" 버튼을 제거합니다.
- **탭 업로드 방식**: "사진이나 동영상을 업로드하세요" 영역을 탭하면 업로드 기능이 작동합니다.
- **모바일 디바이스**: 기기의 사진 앨범 기능을 사용하여 사진/동영상을 선택합니다.
- **웹 환경**: 컴퓨터의 파일 시스템에서 이미지를 업로드할 수 있도록 합니다. (테스트용)
- **크로스 플랫폼 대응**: Flutter의 image_picker를 사용하여 모바일과 웹 모두에서 작동하도록 구현합니다.

### 3단계: 자기소개 입력
- **키** 입력
- **체형** 선택
- **국적** 입력 (휴대폰 번호 인증 시 기본값 자동 설정)
- **MBTI** 입력
- **사용언어** 선택 (최대 3개)
- **인사말** 입력 (100자 이내)
- **음성 인사말** 기능 (선택): 음성 녹음 및 재생 기능

## 1.2 사용자 정의
- 사용자는 기획자/디자이너이며 개발 경험이 없으므로 코딩 지식을 가정하지 않고 설명해야 합니다.

## 1.3 사용자 상호작용 규칙
- 사용자가 채팅에 '?'를 입력하면, 이는 AI(어시스턴트)에게 '지금 즉시 모든 개발/운영 룰을 100% 준수하라'는 명령임을 의미합니다.
- AI는 '?' 입력 시 즉시 룰을 재확인하고, 위반 없이 작업을 진행해야 합니다.
- 사용자가 '시작' 또는 '시작한다고' 말하면, AI(어시스턴트)는 별도 확인이나 추가 질문 없이 즉시 개발(코드 생성/수정/반영 등)을 자동으로 진행해야 합니다.
- 대기, 안내, 추가 질의 없이 바로 작업을 시작하는 것이 원칙입니다.

## 1.4 언어 규칙
- AI(어시스턴트)는 앞으로 한국어로 응답합니다.

---

# 2. 서비스 정책

## 2.1 개발 작업 정책
- 이 프로젝트에서는 사용자가 코드를 직접 만지거나 수정하지 않습니다.
- 모든 코드 생성, 수정, 반영 작업은 AI(어시스턴트)가 직접 수행해야 하며, 사용자는 코드 편집을 하지 않습니다.
- 이 규칙은 모든 개발 작업에서 1순위로 항상 적용됩니다.

## 2.2 터미널 명령 정책
- 사용자는 어시스턴트가 터미널 명령을 직접 실행하기를 원하며, 사용자가 명령을 복사하여 붙여넣기를 원하지 않습니다.
- 사용자는 어시스턴트가 자동으로 터미널 명령을 실행하기를 원합니다.

## 2.3 실행 정책
- 사용자가 "run"이라고 입력하면 자동으로 Flutter 앱을 빌드하고 실행합니다.
- 동일한 내용에 대한 run은 한번으로 축약해서 일괄 진행함
- 프로젝트 CLI 규칙: 'run'을 입력하면 애플리케이션이 실행됩니다.

---

# 3. UX 디자인

## 3.1 Figma 기본 원칙
- Figma에서 생성한 프레임(화면) 명칭을 Flutter(또는 개발) 화면 파일명, 클래스명, 변수명 등에 1:1로 그대로 반영합니다.
- 프레임명 임의 변경, 해석, 축약, 번역, 창작 없이 Figma의 이름을 그대로 사용해야 하며, 이 원칙은 모든 화면/컴포넌트/작업에 항상 적용됩니다.

## 3.2 Figma 정보 추출 규칙
- AI(어시스턴트)는 Figma의 Inspect 패널을 통해 노드의 좌표, 크기, 색상, 폰트, 마진, 패딩 등 모든 속성 정보를 항상 확인하여 추출/확인한 후에만 코딩 및 개발 변경작업을 수행해야 합니다.
- 사용자는 정보를 제공하거나 요청을 받을 필요가 없으며, AI가 Figma에서 직접 검사한 정보를 기반으로 구현해야 합니다.
- AI(어시스턴트)는 사용자에게 Figma 노드의 좌표, 크기, 색상 등 정보를 직접 물어보거나 요청하는 것을 금지합니다.
- 노드 정보를 추출할 때, 노드 정보와 inspect 정보를 동시에 추출하도록 합니다.
- **inspect에 없는 정보는 구현하지 마세요.**

## 3.3 디자인 구현 정확도
- 모든 개발 작업에서 Figma(또는 마크업) 디자인 정보를 100% 동일하게 구현해야 하며, 창작이나 왜곡은 절대 금지합니다.
- 절대 창작하거나 왜곡하지 않고, 오직 디자인에서 추출한 수치, 위치, 정렬, 색상, 폰트, 간격, divider, 이미지(w, i 등) 위치까지 모두 그대로 반영해야 합니다.
- 사용자가 제공한 Figma(또는 마크업) 디자인 정보를 100% 동일하게, 1픽셀 단위까지 정확히 구현해야 합니다.
- 사용자는 UI 디자인이 Figma에 명시된 대로 정확히 구현되기를 원하며, 텍스트 정렬, 구분선 배치, 이미지 위치 등에 대한 창의적 조정을 원하지 않습니다.

## 3.4 좌표 및 크기 변환 규칙
- Figma에서 추출한 레이어의 x, y 좌표와 width, height는 아트보드(프레임) 크기(예: 390x844)가 Flutter Stack(또는 부모 위젯)에 고정되어 있을 경우, 비율 변환 없이 Figma의 값을 그대로 Positioned(left, top, width, height)에 적용합니다.
- 이 프로젝트의 Figma 아트보드(프레임) 크기는 390px * 844px로 고정되어 있으며, 변하지 않는 값입니다.
- 모든 Figma-to-Flutter 좌표 변환 및 UI 반영 시 이 값을 기준으로 비율 계산을 합니다.

## 3.5 컴포넌트 및 에셋 처리
- 버튼에 포함된 아이콘도 SVG로 추출하여 Flutter에 그대로 적용합니다.
- Figma 화면의 노드 중 component로 이루어진 것은 반드시 개발로 구현해 놓은 element(component)를 반영할 것입니다.
- Figma에서 component로 구성된 노드는 기존에 개발된 Flutter component를 사용하여 구현합니다.

## 3.6 레이어 가시성 규칙
- **Figma에서 `visible: false`인 모든 레이어/프레임은 개발에서 절대 제외합니다.**
- **Figma에서 `visible: true`이거나 `visible` 속성이 없는 레이어만 개발에 포함합니다.**
- **사용자가 Figma에서 레이어를 자유롭게 숨길 수 있도록 보장합니다.**
- **눈 아이콘이 꺼진 상태(visible=false)의 모든 요소는 Flutter 코드에서 완전히 제외합니다.**
- **가이드라인, 주석, 메모, 템플릿 요소 등도 개발에서 제외합니다.**
- **레이어 가시성 확인은 Figma MCP 도구로 정확히 검증한 후에만 구현합니다.**
- **확인되지 않은 레이어는 개발에 포함하지 않습니다.**

## 3.7 Figma 작업 효율성
- 모든 Figma 작업(디자인 생성, 수정, 노드 추가 등) 시, 사용자가 여러 번 'run'을 누르지 않도록 합니다.
- 사용자가 한 번만 'run'을 누르면, 나머지 모든 작업(후속 생성, 스타일 적용, 텍스트 추가 등)은 AI(어시스턴트)가 자동으로 연속 실행하여 완성합니다.

## 3.8 검증 프로세스
- 프로젝트 검증 프로세스에 '디자인과 UI 개발 화면이 100% 일치하지 않으면 프로젝트를 진행할 수 없으며, 자동으로 수정해 100% 일치 상태를 유지해야 한다'를 추가합니다.

## 3.9 단위 규칙
- 모든 레이아웃, 스타일, 크기, 간격 등은 반드시 px(픽셀) 단위로 소통하고 기록한다.

---

# 4. Front-end 개발정책

## 4.1 개발 환경
- 사용자는 VS Code에서 Flutter 화면을 빌드하고, Xcode 시뮬레이터(아이폰 등)로 결과를 직접 확인합니다.
- 모든 개발 및 UI 검증은 이 방식으로 진행됩니다.
- 사용자는 오직 Xcode 시뮬레이터를 통해 앱을 실행하며, VS Code나 다른 도구를 통해 실행하지 않습니다.

## 4.2 코딩 컨벤션 규칙
- **이 프로젝트는 camelCase 표기법을 따릅니다.**
- 모든 변수명, 함수명, 메서드명은 camelCase로 작성합니다. (예: userName, validateEmail, showErrorMessage)
- 클래스명과 Figma 레이어명은 PascalCase를 사용합니다. (예: CustomInputField, SignupScreen, StatusBarWidget)
- 상수는 UPPER_SNAKE_CASE를 사용합니다. (예: MAX_LENGTH, API_BASE_URL)
- private 메서드는 언더스코어(_) 접두사 없이 camelCase를 사용합니다.
- 이 규칙은 모든 코드 작성에 항상 적용되며, 기존 코드 수정 시에도 반드시 준수해야 합니다.
- **Figma와 Flutter 명명 규칙**:
  - Figma 레이어명: PascalCase 사용 (예: StatusBarWidget, HeaderTabSection)
  - Flutter 클래스명: PascalCase 사용 (예: StatusBarWidget, HeaderTabSection)
  - Figma와 Flutter의 이름을 1:1로 동일하게 매칭합니다.

---

# 5. 빌드 및 배포 정책

## 5.1 iOS 빌드 환경 관리
- **안정적 빌드 환경 유지**: 캐시 문제 방지를 위한 정기적 정리
- **의존성 관리**: CocoaPods와 Flutter 의존성 동기화 유지
- **빌드 스크립트 사용**: `./scripts/build_ios.sh` 스크립트로 일관된 빌드 환경 제공

## 5.2 빌드 문제 예방 조치
- **Firebase 의존성 완전 제거**: pubspec.yaml, Dart 파일, iOS 네이티브 코드에서 모든 Firebase 관련 코드 제거
- **캐시 정리 자동화**: Xcode DerivedData, Flutter 캐시, CocoaPods 캐시 정기 정리
- **Manifest.lock 동기화**: CocoaPods 설정과 Xcode 프로젝트 간 동기화 유지

## 5.3 빌드 에러 대응
- **즉시 대응**: 빌드 에러 발생 시 `BUILD_TROUBLESHOOTING.md` 문서 참조
- **단계별 해결**: 정리 → 재설치 → Xcode 설정 확인 → 빌드 순서로 진행
- **문서화**: 새로운 빌드 문제 발견 시 해결 방법을 문서에 추가

## 5.4 배포 방식
- **시뮬레이터 우선**: 개발 중에는 시뮬레이터에서 먼저 검증
- **물리적 디바이스**: Xcode를 통한 직접 빌드 권장 (Flutter CLI 대신)
- **코드 서명**: Apple Developer 계정을 통한 자동 서명 설정

## 5.5 Git 관리
- **빌드 산출물 제외**: .gitignore에 모든 빌드 관련 파일/폴더 추가
- **민감 정보 보호**: API 키, 인증서 등 민감한 정보 Git 저장소에서 제외
- **의존성 파일**: Podfile.lock, pubspec.lock 등 자동 생성 파일 제외

---

# 6. Back-end 개발정책

(현재 Back-end 관련 규칙이 정의되지 않음)