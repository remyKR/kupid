import { McpServer } from '@modelcontextprotocol/sdk/server/mcp.js';
import { Paint, Vector, Style } from '@figma/rest-api-spec';
export { startServer } from './cli.js';

declare function createServer(figmaApiKey: string, { isHTTP }?: {
    isHTTP?: boolean;
}): McpServer;

interface SimplifiedLayout {
    mode: "none" | "row" | "column";
    justifyContent?: "flex-start" | "flex-end" | "center" | "space-between" | "baseline" | "stretch";
    alignItems?: "flex-start" | "flex-end" | "center" | "space-between" | "baseline" | "stretch";
    alignSelf?: "flex-start" | "flex-end" | "center" | "stretch";
    wrap?: boolean;
    gap?: string;
    locationRelativeToParent?: {
        x: number;
        y: number;
    };
    dimensions?: {
        width?: number;
        height?: number;
        aspectRatio?: number;
    };
    padding?: string;
    sizing?: {
        horizontal?: "fixed" | "fill" | "hug";
        vertical?: "fixed" | "fill" | "hug";
    };
    overflowScroll?: ("x" | "y")[];
    position?: "absolute";
}

type SimplifiedStroke = {
    colors: SimplifiedFill[];
    strokeWeight?: string;
    strokeDashes?: number[];
    strokeWeights?: string;
};

type SimplifiedEffects = {
    boxShadow?: string;
    filter?: string;
    backdropFilter?: string;
};

interface ComponentRendition {
    name: string;
    id: string;
    description?: string;
}
type TextStyle = Partial<{
    fontFamily: string;
    fontWeight: number;
    fontSize: number;
    lineHeight: string;
    letterSpacing: string;
    textCase: string;
    textAlignHorizontal: string;
    textAlignVertical: string;
}>;
type StyleTypes = TextStyle | SimplifiedFill[] | SimplifiedLayout | SimplifiedStroke | SimplifiedEffects | string;
interface GlobalVars {
    styles: {
        [id: StyleId]: StyleTypes;
    };
    components: Record<string, ComponentRendition>;
    figmaPublishedStyles?: FigmaPublishedStylesMap;
}
interface SimplifiedDesign {
    name: string;
    lastModified: string;
    thumbnailUrl: string;
    nodes: SimplifiedNode[];
    globalVars: GlobalVars;
}
interface SimplifiedNode {
    id: string;
    name: string;
    type: string;
    mainComponentId?: string;
    boundingBox?: BoundingBox;
    text?: string;
    textStyle?: string;
    fills?: string;
    styles?: string;
    strokes?: string;
    effects?: string;
    opacity?: number;
    borderRadius?: string;
    layout?: string;
    children?: SimplifiedNode[];
}
interface BoundingBox {
    x: number;
    y: number;
    width: number;
    height: number;
}
type CSSRGBAColor = `rgba(${number}, ${number}, ${number}, ${number})`;
type CSSHexColor = `#${string}`;
type SimplifiedFill = {
    type?: Paint["type"];
    hex?: string;
    rgba?: string;
    opacity?: number;
    imageRef?: string;
    scaleMode?: string;
    gradientHandlePositions?: Vector[];
    gradientStops?: {
        position: number;
        color: ColorValue | string;
    }[];
} | CSSRGBAColor | CSSHexColor;
interface ColorValue {
    hex: string;
    opacity: number;
}
type FigmaPublishedStylesMap = Record<string, Style>;

type FetchImageParams = {
    nodeId: string;
    fileName: string;
    fileType: "png" | "svg";
};
type FetchImageFillParams = Omit<FetchImageParams, "fileType"> & {
    imageRef: string;
};
declare class FigmaService {
    private readonly apiKey;
    private readonly baseUrl;
    constructor(apiKey: string);
    private request;
    getImageFills(fileKey: string, nodes: FetchImageFillParams[], localPath: string): Promise<string[]>;
    getImages(fileKey: string, nodes: FetchImageParams[], localPath: string): Promise<string[]>;
    getFile(fileKey: string, depth?: number | null): Promise<SimplifiedDesign>;
    getNode(fileKey: string, nodeId: string, depth?: number | null): Promise<SimplifiedDesign>;
    getVariables(fileKey: string, scope?: 'local' | 'published'): Promise<any>;
}

interface ServerConfig {
    figmaApiKey: string;
    port: number;
    configSources: {
        figmaApiKey: "cli" | "env";
        port: "cli" | "env" | "default";
    };
}
declare function getServerConfig(isStdioMode: boolean): ServerConfig;

export { FigmaService, type SimplifiedDesign, createServer, getServerConfig };
